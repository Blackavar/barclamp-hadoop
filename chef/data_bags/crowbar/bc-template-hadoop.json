{
  "id": "bc-template-hadoop",
  "description": "Provides the capability to deploy and maintain a baseline Hadoop cluster environment (HDFS/MapReduce) with additional support for installing hadoop extension packages such as HBase, Hive, Pig, Flume, Sqoop and ZooKeeper.",
  "attributes": {
    "hadoop": {
      "debug": true,
      "admin_ip_eval": "Chef::Recipe::Barclamp::Inventory.get_network_by_type(node, \"admin\").address",
      "admin_interface_eval": "Chef::Recipe::Barclamp::Inventory.get_network_by_type(node, \"admin\").interface",
      "core": {
        "fs_checkpoint_dir": [ "/tmp/hadoop-metadata" ],
        "fs_checkpoint_edits_dir": [ "${fs.checkpoint.dir}" ],
        "fs_checkpoint_period": "3600",
        "fs_checkpoint_size": "67108864",
        "fs_default_name": "file:///",
        "fs_file_impl": "org.apache.hadoop.fs.LocalFileSystem",
        "fs_ftp_impl": "org.apache.hadoop.fs.ftp.FTPFileSystem",
        "fs_har_impl": "org.apache.hadoop.fs.HarFileSystem",
        "fs_har_impl_disable_cache": "true",
        "fs_hdfs_impl": "org.apache.hadoop.hdfs.DistributedFileSystem",
        "fs_hftp_impl": "org.apache.hadoop.hdfs.HftpFileSystem",
        "fs_hsftp_impl": "org.apache.hadoop.hdfs.HsftpFileSystem",
        "fs_kfs_impl": "org.apache.hadoop.fs.kfs.KosmosFileSystem",
        "fs_ramfs_impl": "org.apache.hadoop.fs.InMemoryFileSystem",
        "fs_s3_block_size": "67108864",
        "fs_s3_buffer_dir": "${hadoop.tmp.dir}/s3",
        "fs_s3_impl": "org.apache.hadoop.fs.s3.S3FileSystem",
        "fs_s3_maxRetries": "4",
        "fs_s3_sleepTimeSeconds": "10",
        "fs_s3n_impl": "org.apache.hadoop.fs.s3native.NativeS3FileSystem",
        "fs_trash_interval": "",
        "hadoop_http_filter_initializers": "",
        "hadoop_logfile_count": "10",
        "hadoop_logfile_size": "10000000",
        "hadoop_native_lib": "true",
        "hadoop_rpc_socket_factory_class_ClientProtocol": "",
        "hadoop_rpc_socket_factory_class_default": "org.apache.hadoop.net.StandardSocketFactory",
        "hadoop_security_authentication": "simple",
        "hadoop_security_authorization": "false",
        "hadoop_security_group_mapping": "org.apache.hadoop.security.ShellBasedUnixGroupsMapping",
        "hadoop_security_uid_cache_secs": "14400",
        "hadoop_socks_server": "",
        "hadoop_tmp_dir": "/tmp/hadoop-${user.name}",
        "hadoop_util_hash_type": "murmur",
        "io_bytes_per_checksum": "512",
        "io_compression_codecs": "org.apache.hadoop.io.compress.DefaultCodec,org.apache.hadoop.io.compress.GzipCodec,org.apache.hadoop.io.compress.BZip2Codec",
        "io_file_buffer_size": "4096",
        "io_mapfile_bloom_error_rate": "0.005",
        "io_mapfile_bloom_size": "1048576",
        "io_seqfile_compress_blocksize": "1000000",
        "io_seqfile_lazydecompress": "true",
        "io_seqfile_sorter_recordlimit": "1000000",
        "io_serializations": "org.apache.hadoop.io.serializer.WritableSerialization",
        "io_skip_checksum_errors": "false",
        "ipc_client_connect_max_retries": "10",
        "ipc_client_connection_maxidletime": "10000",
        "ipc_client_idlethreshold": "4000",
        "ipc_client_kill_max": "10",
        "ipc_client_tcpnodelay": "false",
        "ipc_server_listen_queue_size": "128",
        "ipc_server_tcpnodelay": "false",
        "local_cache_size": "10737418240",
        "topology_node_switch_mapping_impl": "org.apache.hadoop.net.ScriptBasedMapping",
        "topology_script_file_name": "",
        "topology_script_number_args": "100",
        "webinterface_private_actions": "false"
      },
      "env": {
        "hadoop_datanode_opts": "",
        "hadoop_heapsize": "1000",
        "hadoop_jobtracker_opts": "",
        "hadoop_log_dir": "/var/log/hadoop",
        "hadoop_namenode_opts": "",
        "hadoop_secondarynamenode_opts": "",
        "hadoop_tasktracker_opts": ""
      },
      "hdfs": {
        "dfs_access_time_precision": "3600000",
        "dfs_balance_bandwidthPerSec": "1048576",
        "dfs_block_access_key_update_interval": "600",
        "dfs_block_access_token_enable": "false",
        "dfs_block_access_token_lifetime": "600",
        "dfs_block_size": "67108864",
        "dfs_blockreport_initialDelay": "",
        "dfs_blockreport_intervalMsec": "3600000",
        "dfs_client_block_write_retries": "3",
        "dfs_data_dir": "${hadoop.tmp.dir}/dfs/data",
        "dfs_datanode_address": "0.0.0.0:50010",
        "dfs_datanode_data_dir_perm": "755",
        "dfs_datanode_dns_interface": "default",
        "dfs_datanode_dns_nameserver": "default",
        "dfs_datanode_du_reserved": "",
        "dfs_datanode_failed_volumes_tolerated": "",
        "dfs_datanode_handler_count": "3",
        "dfs_datanode_http_address": "0.0.0.0:50075",
        "dfs_datanode_https_address": "0.0.0.0:50475",
        "dfs_datanode_ipc_address": "0.0.0.0:50020",
        "dfs_default_chunk_view_size": "32768",
        "dfs_df_interval": "60000",
        "dfs_heartbeat_interval": "3",
        "dfs_hosts": "",
        "dfs_hosts_exclude": "",
        "dfs_http_address": "0.0.0.0:50070",
        "dfs_https_address": "0.0.0.0:50470",
        "dfs_https_client_keystore_resource": "ssl-client.xml",
        "dfs_https_enable": "false",
        "dfs_https_need_client_auth": "false",
        "dfs_https_server_keystore_resource": "ssl-server.xml",
        "dfs_max_objects": "",
        "dfs_name_dir": [ "${hadoop.tmp.dir}/dfs/name" ],
        "dfs_name_edits_dir": [ "${dfs.name.dir}" ],
        "dfs_namenode_decommission_interval": "30",
        "dfs_namenode_decommission_nodes_per_interval": "5",
        "dfs_namenode_delegation_key_update_interval": "86400000",
        "dfs_namenode_delegation_token_max_lifetime": "604800000",
        "dfs_namenode_delegation_token_renew_interval": "86400000",
        "dfs_namenode_handler_count": "10",
        "dfs_namenode_logging_level": "info",
        "dfs_permissions": "true",
        "dfs_permissions_supergroup": "supergroup",
        "dfs_replication": "3",
        "dfs_replication_considerLoad": "true",
        "dfs_replication_interval": "3",
        "dfs_replication_max": "512",
        "dfs_replication_min": "1",
        "dfs_safemode_extension": "30000",
        "dfs_safemode_threshold_pct": "0.999f",
        "dfs_secondary_http_address": "0.0.0.0:50090",
        "dfs_support_append": "false",
        "dfs_web_ugi": "webuser,webgroup"
      },
      "mapred": {
        "hadoop_job_history_location": "",
        "hadoop_job_history_user_location": "",
        "hadoop_rpc_socket_factory_class_JobSubmissionProtocol": "",
        "io_map_index_skip": "",
        "io_sort_factor": "10",
        "io_sort_mb": "100",
        "io_sort_record_percent": "0.05",
        "io_sort_spill_percent": "0.80",
        "job_end_retry_attempts": "",
        "job_end_retry_interval": "30000",
        "jobclient_output_filter": "FAILED",
        "keep_failed_task_files": "false",
        "map_sort_class": "org.apache.hadoop.util.QuickSort",
        "mapred_acls_enabled": "false",
        "mapred_child_env": "",
        "mapred_child_java_opts": "-Xmx200m",
        "mapred_child_tmp": "./tmp",
        "mapred_child_ulimit": "",
        "mapred_cluster_map_memory_mb": "-1",
        "mapred_cluster_max_map_memory_mb": "-1",
        "mapred_cluster_max_reduce_memory_mb": "-1",
        "mapred_cluster_reduce_memory_mb": "-1",
        "mapred_compress_map_output": "false",
        "mapred_healthChecker_interval": "60000",
        "mapred_healthChecker_script_args": "",
        "mapred_healthChecker_script_path": "",
        "mapred_healthChecker_script_timeout": "600000",
        "mapred_heartbeats_in_second": "100",
        "mapred_hosts": "",
        "mapred_hosts_exclude": "",
        "mapred_inmem_merge_threshold": "1000",
        "mapred_job_map_memory_mb": "-1",
        "mapred_job_queue_name": "default",
        "mapred_job_reduce_input_buffer_percent": "0.0",
        "mapred_job_reduce_memory_mb": "-1",
        "mapred_job_reuse_jvm_num_tasks": "1",
        "mapred_job_shuffle_input_buffer_percent": "0.70",
        "mapred_job_shuffle_merge_percent": "0.66",
        "mapred_job_tracker": "local",
        "mapred_job_tracker_handler_count": "10",
        "mapred_job_tracker_history_completed_location": "",
        "mapred_job_tracker_http_address": "0.0.0.0:50030",
        "mapred_job_tracker_jobhistory_lru_cache_size": "5",
        "mapred_job_tracker_persist_jobstatus_active": "false",
        "mapred_job_tracker_persist_jobstatus_dir": "/jobtracker/jobsInfo",
        "mapred_job_tracker_persist_jobstatus_hours": "",
        "mapred_job_tracker_retiredjobs_cache_size": "1000",
        "mapred_jobtracker_blacklist_fault_bucket_width": "15",
        "mapred_jobtracker_blacklist_fault_timeout_window": "180",
        "mapred_jobtracker_completeuserjobs_maximum": "100",
        "mapred_jobtracker_job_history_block_size": "3145728",
        "mapred_jobtracker_maxtasks_per_job": "-1",
        "mapred_jobtracker_restart_recover": "false",
        "mapred_jobtracker_taskScheduler": "org.apache.hadoop.mapred.JobQueueTaskScheduler",
        "mapred_jobtracker_taskScheduler_maxRunningTasksPerJob": "",
        "mapred_line_input_format_linespermap": "1",
        "mapred_local_dir": [ "${hadoop.tmp.dir}/mapred/local" ],
        "mapred_local_dir_minspacekill": "",
        "mapred_local_dir_minspacestart": "",
        "mapred_map_max_attempts": "4",
        "mapred_map_output_compression_codec": "org.apache.hadoop.io.compress.DefaultCodec",
        "mapred_map_tasks": "2",
        "mapred_map_tasks_speculative_execution": "true",
        "mapred_max_tracker_blacklists": "4",
        "mapred_max_tracker_failures": "4",
        "mapred_merge_recordsBeforeProgress": "10000",
        "mapred_min_split_size": "",
        "mapred_output_compress": "false",
        "mapred_output_compression_codec": "org.apache.hadoop.io.compress.DefaultCodec",
        "mapred_output_compression_type": "RECORD",
        "mapred_queue_default_state": "RUNNING",
        "mapred_queue_names": "default",
        "mapred_reduce_copy_backoff": "300",
        "mapred_reduce_max_attempts": "4",
        "mapred_reduce_parallel_copies": "5",
        "mapred_reduce_slowstart_completed_maps": "0.05",
        "mapred_reduce_tasks": "1",
        "mapred_reduce_tasks_speculative_execution": "true",
        "mapred_skip_attempts_to_start_skipping": "2",
        "mapred_skip_map_auto_incr_proc_count": "true",
        "mapred_skip_map_max_skip_records": "",
        "mapred_skip_out_dir": "",
        "mapred_skip_reduce_auto_incr_proc_count": "true",
        "mapred_skip_reduce_max_skip_groups": "",
        "mapred_submit_replication": "10",
        "mapred_system_dir": "${hadoop.tmp.dir}/mapred/system",
        "mapred_task_cache_levels": "2",
        "mapred_task_profile": "false",
        "mapred_task_profile_maps": "0-2",
        "mapred_task_profile_reduces": "0-2",
        "mapred_task_timeout": "600000",
        "mapred_task_tracker_http_address": "0.0.0.0:50060",
        "mapred_task_tracker_report_address": "127.0.0.1:0",
        "mapred_task_tracker_task_controller": "org.apache.hadoop.mapred.DefaultTaskController",
        "mapred_tasktracker_dns_interface": "default",
        "mapred_tasktracker_dns_nameserver": "default",
        "mapred_tasktracker_expiry_interval": "600000",
        "mapred_tasktracker_indexcache_mb": "10",
        "mapred_tasktracker_map_tasks_maximum": "2",
        "mapred_tasktracker_memory_calculator_plugin": "",
        "mapred_tasktracker_reduce_tasks_maximum": "2",
        "mapred_tasktracker_taskmemorymanager_monitoring_interval": "5000",
        "mapred_tasktracker_tasks_sleeptime_before_sigkill": "5000",
        "mapred_temp_dir": "${hadoop.tmp.dir}/mapred/temp",
        "mapred_user_jobconf_limit": "5242880",
        "mapred_userlog_limit_kb": "",
        "mapred_userlog_retain_hours": "24",
        "mapreduce_job_acl_modify_job": "",
        "mapreduce_job_acl_view_job": "",
        "mapreduce_job_complete_cancel_delegation_tokens": "true",
        "mapreduce_job_counters_limit": "120",
        "mapreduce_job_split_metainfo_maxsize": "10000000",
        "mapreduce_jobtracker_staging_root_dir": "${hadoop.tmp.dir}/mapred/staging",
        "mapreduce_reduce_input_limit": "-1",
        "mapreduce_reduce_shuffle_connect_timeout": "180000",
        "mapreduce_reduce_shuffle_read_timeout": "180000",
        "mapreduce_tasktracker_group": "",
        "mapreduce_tasktracker_outofband_heartbeat": "false",
        "tasktracker_http_threads": "40"
      },
      "hbase": {
        "hbase_client_pause": "1000",
        "hbase_client_retries_number": "10",
        "hbase_client_scanner_caching": "1",
        "hbase_client_write_buffer": "2097152",
        "hbase_cluster_distributed": "false",
        "hbase_hash_type": "murmur",
        "hbase_hbasemaster_maxregionopen": "120000",
        "hbase_hregion_majorcompaction": "86400000",
        "hbase_hregion_max_filesize": "268435456",
        "hbase_hregion_memstore_block_multiplier": "2",
        "hbase_hregion_memstore_flush_size": "67108864",
        "hbase_hregion_preclose_flush_size": "5242880",
        "hbase_hstore_blockingStoreFiles": "7",
        "hbase_hstore_blockingWaitTime": "90000",
        "hbase_hstore_compaction_max": "10",
        "hbase_hstore_compactionThreshold": "3",
        "hbase_master_dns_interface": "default",
        "hbase_master_dns_nameserver": "default",
        "hbase_master_info_bindAddress": "0.0.0.0",
        "hbase_master_info_port": "60010",
        "hbase_master_lease_period": "120000",
        "hbase_master_meta_thread_rescanfrequency": "60000",
        "hbase_master_port": "60000",
        "hbase_regions_percheckin": "10",
        "hbase_regions_slop": "0.3",
        "hbase_regionserver_class": "org.apache.hadoop.hbase.ipc.HRegionInterface",
        "hbase_regionserver_dns_interface": "default",
        "hbase_regionserver_dns_nameserver": "default",
        "hbase_regionserver_flushlogentries": "100",
        "hbase_regionserver_global_memstore_lowerLimit": "0.35",
        "hbase_regionserver_global_memstore_upperLimit": "0.4",
        "hbase_regionserver_handler_count": "25",
        "hbase_regionserver_info_bindAddress": "0.0.0.0",
        "hbase_regionserver_info_port": "60030",
        "hbase_regionserver_info_port_auto": "false",
        "hbase_regionserver_lease_period": "60000",
        "hbase_regionserver_logroll_period": "3600000",
        "hbase_regionserver_msginterval": "1000",
        "hbase_regionserver_nbreservationblocks": "4",
        "hbase_regionserver_optionallogflushinterval": "10000",
        "hbase_regionserver_port": "60020",
        "hbase_regionserver_thread_splitcompactcheckfrequency": "20000",
        "hbase_rootdir": "file:///tmp/hbase-${user.name}/hbase",
        "hbase_server_thread_wakefrequency": "10000",
        "hbase_tmp_dir": "/tmp/hbase-${user.name}",
        "hbase_zookeeper_dns_interface": "default",
        "hbase_zookeeper_dns_nameserver": "default",
        "hbase_zookeeper_leaderport": "3888",
        "hbase_zookeeper_peerport": "2888",
        "hbase_zookeeper_property_clientPort": "2181",
        "hbase_zookeeper_property_dataDir": "${hbase.tmp.dir}/zookeeper",
        "hbase_zookeeper_property_initLimit": "10",
        "hbase_zookeeper_property_maxClientCnxns": "30",
        "hbase_zookeeper_property_syncLimit": "5",
        "hbase_zookeeper_property_tickTime": "3000",
        "hbase_zookeeper_quorum": "localhost",
        "hfile_block_cache_size": "0.2",
        "hfile_min_blocksize_size": "65536",
        "zookeeper_pause": "2000",
        "zookeeper_retries": "5",
        "zookeeper_session_timeout": "60000",
        "zookeeper_znode_parent": "/hbase",
        "zookeeper_znode_rootserver": "root-region-server",
        "zookeeper_znode_safemode": "safe-mode"
      },
      "hive": {
        "hive_default_fileformat": "TextFile",
        "hive_exec_compress_intermediate": "false",
        "hive_exec_compress_output": "false",
        "hive_exec_scratchdir": "/tmp/hive-${user.name}",
        "hive_exec_script_maxerrsize": "100000",
        "hive_join_emit_interval": "1000",
        "hive_map_aggr": "false",
        "hive_metastore_connect_retries": "5",
        "hive_metastore_local": "true",
        "hive_metastore_metadb_dir": "file:///var/metastore/metadb/",
        "hive_metastore_rawstore_impl": "org.apache.hadoop.hive.metastore.ObjectStore",
        "hive_metastore_uris": "file:///var/metastore/metadb/",
        "hive_metastore_warehouse_dir": "/user/hive/warehouse",
        "javax_jdo_option_ConnectionDriverName": "org.apache.derby.jdbc.EmbeddedDriver",
        "javax_jdo_option_ConnectionURL": "jdbc:derby:;databaseName=metastore_db;create=true"
      },
      "scheduler": {
        "default_min_share_preemption_timeout": "600",
        "default_pool_scheduling_mode": "fair",
        "fair_share_preemption_timeout": "600",
        "pool_max_jobs_default": "20",
        "user_max_jobs_default": "10"
      }
    }
  },
  "deployment": {
    "hadoop": {
      "crowbar-revision": 0,
      "elements": {},
      "element_order": [
        [ 
          "hadoop-masternamenode",
          "hadoop-secondarynamenode",
          "hadoop-slavenode",
          "hadoop-edgenode",
          "hadoop-hbase-masternode",
          "hadoop-hbase-regionserver",
          "hadoop-flume-masternode",
          "hadoop-flume-slavenode"
        ]
      ],
      "config": {
        "environment": "hadoop-base-config",
        "mode": "full",
        "transitions": true,
        "transition_list": [
          "installed"
        ]
      } 
    }
  }
}

